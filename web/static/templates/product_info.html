{% extends "base.html" %}

{% block title %}{{ product.Name }}{% endblock %}

{% block head %}
<link rel="stylesheet" href="/static/css/product_info.css">
{% endblock %}

{% block content %}
<div class="container">
    <h2>{{ product.Name }}</h2>
</div>

<div class="content-wrapper">
    <div id="product-data" data-product-id="{{ product.Id }}" class="main-content">
        <div class="product-details">
            <img src="{{ product.ImageURL }}" alt="{{ product.Name }}" class="product-image">
            <div class="product-info">
                <h3>Ціна: ${{ product.Price }}</h3>
                <p><strong>Тип:</strong> {{ product.Type }}</p>
                <p><strong>Власник:</strong> {{ product.Owner }}</p>
                {% if product.Genre %}
                <p><strong>Жанр:</strong> {{ product.Genre }}</p>
                {% endif %}
                <p><strong>Опис:</strong> {{ product.Description }}</p>
                <p><strong>id:</strong> {{ product.Id }}</p>

                <!-- Кнопка додавання до кошика -->
                <form action="/cart/add" method="POST" class="action-form">
                    <input type="hidden" name="product_id" value="{{ product.Id }}">
                    <button type="submit" class="add-to-cart-button">Додати до кошика</button>
                </form>

                <!-- Якщо це аудіо -->
                {% if product.Type == "audio" %}
                <div class="audio-controls">
                    <button onclick="playAudio('{{ product.Id }}')" class="play-button">Play</button>
                    <form action="/playlist/add" method="POST" class="action-form">
                        <input type="hidden" name="product_id" value="{{ product.Id }}">
                        <select name="playlist_id" required>
                            <option value="">Оберіть плейлист</option>
                            {% for playlist in playlists %}
                            <option value="{{ playlist.id }}">{{ playlist.name }}</option>
                            {% endfor %}
                        </select>
                        <button type="submit" class="add-to-playlist-button">Додати до плейлиста</button>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>

        <a href="/catalogue/{{ product.Owner }}/{{ product.Type }}" class="back-to-catalogue">Повернутись до каталогу</a>
    </div>
    
    <!-- Коментарі -->
    <div class="comments-section">
        <h3>Коментарі</h3>

        {% if user.Username %}
        <div id="user-data" data-user-id="{{ user.ID }}" class="add-comment-form">
            <textarea id="comment-text" placeholder="Напишіть ваш коментар..."></textarea>
            <div class="comment-actions">
                <label class="like-product">
                    <input type="checkbox" id="likes-product">
                    <span class="heart-icon">❤️</span> Подобається продукт
                </label>
                <button id="submit-comment">Додати коментар</button>
            </div>
        </div>
        {% else %}
        <p class="login-to-comment">Увійдіть в систему, щоб залишити коментар</p>
        {% endif %}

        <div id="comments-list" class="comments-list">
            <div class="loading-comments">Завантаження коментарів...</div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/product_info.js"></script>
{% endblock %}
